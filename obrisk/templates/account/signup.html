{% extends 'account/base-min.html' %}
{% load i18n %}
{% load static %}
{% load account socialaccount %}
{% load crispy_forms_tags %}
{% block head %}
<title>{% trans 'Account Signup' %}</title>
<script src="{% static 'js/jquery.min.js' %}" type="text/javascript"></script>
{% endblock head %}

{% block content %}
<script>
	function disableSubmit() {
		document.getElementById("phone-signup-submit").disabled = true;
	}

	function activateButton(element) {

		if (element.checked) {
			document.getElementById("phone-signup-submit").disabled = false;
		}
		else {
			document.getElementById("phone-signup-submit").disabled = true;
		}

	}
</script>

<div class="limiter">
	<div class="container-login100">
		<div class="wrap-login100 p-l-85 p-r-85 p-t-55 p-b-55">
			<span class="login100-form-title p-b-32">{% trans 'Account Creation' %}</span>


{% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-error">
                <strong>{{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}


			<span class="txt3">
				<p>Already have an account? Then please sign in <a href="{% url 'account_login' %}">
						here</a>.</p>
			</span>

			<form class="signup" id="signup_form" method="post" action="{% url 'account_signup' %}">
				{% csrf_token %}
				<h5 class="text-center mt-3">Please enter your address. </h5>
				<div class="input-group mb-3 mt-4">
					<div class="input-group-prepend">
						<label class="input-group-text" for="province">Province</label>
					</div>
					<select class="custom-select" id="province" name="province"></select>
				</div>

				<div class="input-group mb-3">
					<div class="input-group-prepend">
						<label class="input-group-text" for="city">City</label>
					</div>
					<select class="custom-select" id="city" name="city"> </select>
				</div>
				
				<!-- These 2 fields are hidden fields!-->
				<div class="form-row">
					<div class="form-group col-md-12 mb-0">
						{{ form.province_region|as_crispy_field }}
						{{ form.city|as_crispy_field }}
					</div>
				</div>
				
				
				<div class="form-row align-items-center" style="flex-wrap:nowrap">
					<div class="form-group col-xs-6 mb-0 ">
						{{ form.phone_number|as_crispy_field }}
					</div>

					<div class="col-xs-6 mt-4 mb-0">
						<button class="btn code-btn btn-dark" id="send-code" type="button"> Get code</button> 
      				</div>
				</div>

				<small class="text-muted phone_label" id="phone_label"> Don't include the country code!</small>

				<div id="code-notice" style="font-weight:bold;"></div>

				<div class="form-row" id="code">
					<label class="mr-2"> Code: </label>
					<div class="d-flex">
						<input class="form-control col-xs-6" type="tel" pattern="[0-9]{6}" name="code" id="code">
						<button class="btn btn-dark code-btn ml-2 col-xs-2" type="button" id="phone-verify" > Verify </button>
					</div>

				</div>
				<div id="results" style="font-weight:bold;"> </div>

				<div class="name_and_psword" id="name_and_psword">
					<div class="form-row mt-3">
						<div class="form-group col-md-12 mb-0">
							{{ form.username|as_crispy_field }}
						</div>
					</div>
						
					<div class="form-row">
						<div class="form-group col-md-12 mb-0">
							{{ form.password1|as_crispy_field }}
						</div>
					</div>

					<div class="form-row">
						<div class="form-group col-md-12 mb-0">
							{{ form.password2|as_crispy_field }}
						</div>
					</div>

					<input type="hidden" name="verified_no" id="verified_no">
					<input type="checkbox" name="terms" id="terms" onchange="activateButton(this)">
					I Agree to <a href="{% url 'terms_and_conditions' %}">Terms & Conditions </a> and to abide with the
					laws and regulations of the country residing.</a>

					{% if redirect_field_value %}
						<input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
					{% endif %}
					<div class="form-group container-login100-form-btn justify-content-center mt-4">
						<button disabled type="submit" id="phone-signup-submit" class="login100-form-btn">{% trans 'Sign Up' %}
							&raquo;</button>
					</div>
				</div>	

			</form>
			<br/>
			<div> <small class="mt-5" id="support"> If you have any problem with signing up, Please 
			<a href="mailto:support@obrisk.com" > click here </a> to contact us or via WechatID: 
			<span style="font-weight:bold; color: #0aeee3"> Obrisk. </span> </small>  </div>
		 	{% comment %} <small class="mt-5" id="email-request"> <a href=" {% url 'users:email_signup' %} "> Request to signup with your email </a> </small> {% endcomment %} 

		</div>
	</div>
</div>

<script src="{% static 'js/bootstrap.min.js' %}" type="text/javascript"></script>

<script type="text/javascript"> 
	var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
	var current_url = "{{ request.path }}"; 
	var errors = false;


	{% if form.errors %}
		errors = true;
		{% if "phone_number" in form.errors %}
			$("#id_phone_number").attr("disabled", false);
			$("#id_phone_number").val($("#id_phone_number").val().replace('+86', ''));
		{% else %}
			$("#id_phone_number").attr("disabled", true);
			$("input[name='verified_no']").val("VAL"); 
			$("#phone_label").hide();
			$("#code").hide();
			$("#send-code").hide();
		{% endif %}
			
	{% endif %} 

</script>
<script src="{% static 'js/user-form.js' %}?v=0908192" type="text/javascript"> </script>
<script src="{% static 'js/location.js' %}?v=0208191" type="text/javascript"> </script>


{% endblock content %}
{% extends "base.html" %}
{% load static i18n %}
{% block title %}{% trans 'Contacts' %}{% endblock %}

{% block head %}
<link href="{% static 'css/messager.css' %}" rel="stylesheet">
{% endblock head %}

{% block content %}
{% include "chats.html" %}

    {% if object.is_official %}
            
      <a class="btn btn-outline-dark" href="{% url 'friends:friendship_followers'  user  %}">{% trans 'my followersü§ù' %}</a>

    {% endif %}
    <div class="row" style="margin-top: 1em" style="overflow: scroll!important"></div>
<div class="row" style="margin-top: 1em" style="overflow: scroll!important">

  <div class="col-md-8 m-auto title">
    <h4 style="color: black; font-weight: bold;">{% trans 'Recent Messages' %}</h4>
  </div>

  <div class="col-md-8 col-10 m-auto list-group users-list " style="overflow: scroll!important">
    {% for user, msg in zip_list %}
        <a href="{% url 'messager:conversation_detail' user  %}" class="card p-4 mb-3 d-flex flex-row ">
            {% if user.thumbnail %}
                <img src="https://obrisk.oss-cn-hangzhou.aliyuncs.com/{{user.thumbnail}}" alt="Picture Profile"
                style="width:40px;height:40px;border-radius: 50%;"
                class="rounded-circle  mb-3 mb-md-0 mr-md-3 profile-header-avatar img-fluid" id="pic">
            {% else %}
                <img src="{% static 'img/user.png' %}" height="40px" alt="No Profile Picture" />
            {% endif %}
      
          <strong> {{ user.get_profile_name|title }} </strong>
          <span id="last-msg"> {{ msg.message|truncatechars:50 }} </span>
          <span id="msg-timestamp"> {{ msg.timestamp|date:'N d G:i' }} </span>

          {%  if msg.unread and request.user == msg.recipient %}
          <span class="pull-right ml-2" id="new-msgs"> <i class="fa fa-circle" aria-hidden="true"></i> </span>
          {% endif %}
    </a>

    {% empty %}
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <h4> {% trans "You don't have any contacts in your account." %} </h4>
        </li>
      </ol>
    </nav>

    <p>{% trans "Start a chat from the classifieds details or invite new friends! " %}</p>
    <p>{% trans "If you have questions, then you can chat with the Obrisk team member below... " %}</p>
    <p>{% trans "We will reply you within the shortest time possible." %}</p>

    <a href="{% url 'messager:conversation_detail' super_users.first.username  %}"
      class="list-group-item list-group-item-action ">
      {% if super_users.first.thumbnail %}
          <img src="https://obrisk.oss-cn-hangzhou.aliyuncs.com/{{super_users.first.thumbnail}}" alt="Picture Profile"
          style="width:40px;height:40px;border-radius: 50%;"
          class="rounded-circle  mb-3 mb-md-0 mr-md-3 profile-header-avatar img-fluid" id="pic">
      {% else %}
          <img src="{% static 'img/user.png' %}" height="40px" alt="No Profile Picture" />
      {% endif %}
      <strong> {{ super_users.first.get_profile_name|title }} </strong> </a>
  </div>
  {% endfor %}
</div>
{% endblock content %}

{% block extra_js %}
<script src="{% static 'js/messager.js' %}" type="text/javascript"></script>
{% endblock extra_js %}
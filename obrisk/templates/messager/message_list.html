{% extends "base.html" %}
{% load static i18n %}
{% load thumbnail %}
{% block title %}{% trans 'Messages' %}{% endblock %}

{% block head %}
  <link href="{% static 'css/messager.css' %}" rel="stylesheet">
{% endblock head %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'messager:contacts_list' %}">{% trans 'Contacts ' %}</a></li>
        <!-- <li style="padding-left: 2%">  -->
            {# thumbnail user.picture "x30" as im or get username from {% request.path %} #} 
              <!-- <img src="{{ im.url }}" style="border-radius: 50%;" alt="{% trans 'User Image' %}" class="user-image"> -->
            {# empty #}
              <!-- <img src="{% static 'img/user.png' %}"  height="30px" alt="{% trans 'No Profile Picture' %}" /> -->
            {# endthumbnail #}
          <!-- </li> -->
        <li class="breadcrumb-item active {% if active == user.username %}active{% endif %}" aria-current="page" > {{ active}} </li>
    </ol>
</nav>

  <div class="row">
   <div class="card">
      <div id="messages" class="card-body" ref="chatBody">
            {% if message_list %}
              {% for message in message_list %}
                  {% include 'messager/single_message.html' with message=message %}
              {% endfor %}
            {% else %}
              <h4>{% trans 'Hello '  %} {{ request.user.username }}{% trans ' nice to meet you' %}</h4>
              <p>{% trans "I am " %} {{ active }} {% trans ", Let's talk!" %}</p>
            {% endif %}
        <li class="send-message"></li> <!-- This will hold the space btn few messages that aren't full page and chat-box-->
      </div>

  <div class="chat-box">
      <form role="form" method="post" action="#" id="send">
        <div class="form-group">
          {% csrf_token %}
          <div class="input-group">
            <input type="hidden" name="to" value="{{ active }}">
            <input class="form-control" name="message" placeholder="{% trans 'Write a message...' %}" maxlength="1000" autofocus autocomplete="off" style="width: 110px;">
            <div class="input-group-append">
              <button class="msg_send_btn" type="submit"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></span>
            </div> 
            </div>
        </div>
      </form>
    </div>
    <!-- card end-->
  </div>
</div>


{% endblock content %}

{% block modal %}
  <script type="text/javascript">
      var activeUser = "{{ active }}";
      //This scrolls the div #messages only to the bottom
      var d = $('#messages');
      d.scrollTop(d.prop("scrollHeight"));

  </script>
  <script src="{% static 'js/messager.js' %}" type="text/javascript"></script>
{% endblock modal %}

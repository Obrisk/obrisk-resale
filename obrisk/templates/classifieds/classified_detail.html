{% extends 'base.html' %}
{% load static i18n %}
{% load crispy_forms_tags thumbnail humanize %}

{% block head %}
<link href="{% static 'css/classifieds.css' %}" rel="stylesheet">
<link href="{% static 'css/classified-details.css' %}" rel="stylesheet">
<link href="{% static 'css/colors.css' %}" rel="stylesheet">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/css/swiper.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/css/swiper.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/js/swiper.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/js/swiper.min.js"></script>
{% endblock head %}

{% block title %}{{ classified.title|title }}{% endblock %}

{% block content %}
<!-- Page Content -->
<div class="container">

  <div class="row">
    <!-- Post Content Column -->

    <div class="classified-wrapper col-lg-8 col-md-10 m-auto">

      <section class="col">
        <div class="classified-meta mb-4">
          <!-- Title -->
          <h3 class="mt-4 text-left">{{ classified.title|title }}</h3>

          <div class="meta-details mt-4 d-flex justify-content-between flex-column flex-md-row">

            <div class="meta-right d-flex">
              <a href="{% url 'users:detail' classified.user.username %}">
                {% thumbnail classified.user.picture "30x30" crop="center" upscale="true" as im %}
                <img src="{{ im.url }}" class="pull-left mr-4" style="border-radius: 50%;"
                  alt="{% trans 'User Image' %}" class="user-image">
                {% empty %}
                <img src="{% static 'img/user.png' %}" class="pull-left mr-4" height="35px"
                  alt="{% trans 'No Profile Picture' %}" />
                {% endthumbnail %}
              </a>
              <!-- Location -->
              <div class="meta-left d-flex flex-column">
                <strong id="classified-user"> {{ classified.user.get_profile_name|title }} </strong>
                <div class="location">
                  <small class="card-subtitle mb-2">üìç</small><span class="card-subtitle mb-2">
                    {{ classified.located_area }} ,{{ classified.city }}</span>
                </div>
                <!-- Date/Time -->
                <div class="time mt-2"><small>‚è≤Ô∏è</small><span>{{ classified.timestamp|naturaltime }} </span></div>

              </div>
            </div>
            <div
              class="meta-right mt-md-0 mt-4 col-8 d-flex flex-column align-items-baseline align-items-md-end ml-auto mr-auto">
              <!-- Price -->
              <h3 class="O-cl-red price">
                <strong class="ribbon-content">{% trans 'CNY' %} {{ classified.price }}</strong>
              </h3>
              {% if request.user != classified.user  %}
              <strong>Seller Info :</strong>
              {{ classified.contact_info }}
              <a href="{% url 'messager:conversation_detail' classified.user.username  %}" class="btn btn-action">
                <i class="lead fa fa-shopping-cart"></i> <strong> {% trans ' Chat with seller' %} </strong></a> <br>
              <br>
              {% endif %}
            </div>

          </div>

        </div>
        <div class="col-9 m-auto h-50">
          {% include 'classifieds/image-swiper.html' with message=message %}

        </div>
        <div class="card-text text-justify">{{ classified.details }}</div>
      </section>


      <!-- Cloud Tag Widget -->
      <div class="card my-4">
        <h5 class="card-header">{% trans 'Tags' %}</h5>
        <div class="card-body">
          {% for tag in classified.tags.all %}
          <a href="{% url 'classifieds:list_by_tag' tag %}"><span class="badge badge-info">{{ tag }}</span></a>
          {% endfor %}
        </div>
      </div>

      <!-- Navigation buttons -->
      <div class="m-4">
        {% if request.user == classified.user%}
        <a class="btn btn-dark" href="{% url 'classifieds:edit_classified' classified.id %}"
          title="{% trans 'Edit this classified' %}">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i> {% trans 'Edit' %}</a>
        {% else %}

        <!-- <a href="{% url 'classifieds:report_classified' classified.id %}" class="btn btn-danger" title="{% trans 'Report this classified' %}">{% trans 'Report' %} </a> -->
        {% endif %}
        <a href="{% url 'classifieds:list' %}" class="btn btn-dark"> &larr;{% trans 'Back' %} </a><br> <br>

      </div>
    </div>


    <!-- Similar lassified -->
    {% if similar_classifieds %}
    <div class="col-lg-8 col-md-10 mr-auto ml-auto related-card mt-4 pt-4 mb-4">
      <div class=" related mt-4 mb-4">
        <h5 class="text-left">Related Classifieds</h5>
        <!-- Classified Entries Column -->
        <!-- <div class="col-md-8"> -->
        {% for classified in similar_classifieds %}
        <!-- Classified ad. -->
        <div class="card classified-card mr-2 mb-3">
          <!--Display image-->
          <div class="card-img-top img-responsive">
            <a href="{% url 'classifieds:classified' classified.slug %}"
              style="color:black; text-decoration:none; background-color:none">
              {% for photo in all_images %}
              {% if photo.classified == classified %}
              <img class="card-img" src="https://obrisk.oss-cn-hangzhou.aliyuncs.com/{{ photo.image_thumb }}">
              {{ "<!--" }}
              {% endif %}
              {% endfor %}
              {{ "-->" }}
          </div>

          <div class="card-body">
            <h6 class="card-title"> {{ classified.title|truncatechars:20}} </h6>
            <p class="card-subtitle O-cl-red"> CNY {{ classified.price|title }} </p>
            <div class="card-meta d-flex justify-content-between">
              <div class="location">
                <small>üìç</small>
                <span class="card-text small "> {{ classified.city|safe }}</span>
              </div>
              <div class="share-card">
                <small>üîó</small>
              </div>
            </div>

          </div>
          </a>
        </div>
        {% endfor %}
      </div>

    </div>

  </div>
  {% endif %}


</div>

<script type="text/javascript">

</script>
{% endblock content %}
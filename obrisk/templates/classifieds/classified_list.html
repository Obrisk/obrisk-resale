{% extends 'base.html' %}
{% load static i18n %}
{% load humanize thumbnail %}

{% block title %} {% trans 'Classifieds' %} {% endblock %}

{% block head %}
<link href="{% static 'css/listing.css' %}" rel="stylesheet">
<link href="{% static 'css/classifieds.css' %}" rel="stylesheet">
{% endblock head %}

{% block content %}
<!-- Page Content -->
<div class="container">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'posts:list' %}">{% trans 'Home' %}</a></li>
      <li class="breadcrumb-item active"><a href="{% url 'classifieds:list' %}">{% trans 'Classifieds' %}</a></li>
    </ol>
  </nav>

    <div class="row justify-content-center ">
      <!-- Classified Entries Column -->
      <!-- <div class="col-md-8"> -->
        {% for classified in classifieds %}
          <!-- Classified ad. -->
          <div class="card classified-card mr-2 mb-3 justify-content-center" >  
              <!--Display image-->
              <div class="card-img-top img-responsive">
                <a href="{% url 'classifieds:classified' classified.slug %}"  style="color:black; text-decoration:none; background-color:none" >
                {% for photo in images %}
                    {% if photo.classified == classified %}
                      <img class="card-img" src="http://obrisk.oss-cn-hangzhou.aliyuncs.com/{{ photo.image_thumb }}">   
                {{ "<!--" }}      
                {% endif %}
                {% endfor %}
                {{ "-->" }}
            </div>
            
            <div class="card-body">  
                <h6 class="card-title" > {{ classified.title}} <h6> 
                <small class="card-subtitle text-danger"> CNY {{ classified.price|title|truncatechars:20 }} </small> <br>
                <i class="lead fa fa-map-marker"></i>
                <span class="card-text small "> {{ classified.city|safe }}</span>    
            </div>
          </a>
        </div>  
             
        {% empty %}
          <h6 class="no-data">{% trans 'Dear '%} {{ request.user.username }} 
          {% trans 'you are welcome. Mmh! It looks like there are no posts near you.' %}
           <a href="{% url 'classifieds:write_new' %}"> {% trans ' be the first one to post.' %}!</a> 
           {% trans 'Or check what we have found from other places '%}  </h6>
           <br />
        {% endfor %}
      

   <!--Will be using ajax in near future.-->

    {% for classified in other_classifieds %}
          <!-- Classified ad. -->
          <div class="card classified-card mr-2 mb-3 justify-content-center" >  
              <!--Display image-->
              <div class="card-img-top img-responsive">
                <a href="{% url 'classifieds:classified' classified.slug %}"  style="color:black; text-decoration:none; background-color:none" >
                {% for photo in images %}
                    {% if photo.classified == classified %}
                      <img src="http://obrisk.oss-cn-hangzhou.aliyuncs.com/{{ photo.image_thumb }}">   
                {{ "<!--" }}      
                {% endif %}
                {% endfor %}
                {{ "-->" }}
            </div>
            
            <div class="card-body">  
                <h6 class="card-title" > {{ classified.title}} <h6> 
                <small class="card-subtitle text-danger"> CNY {{ classified.price|title|truncatechars:20 }} </small> <br>
                <i class="lead fa fa-map-marker"></i>
                <span class="card-text small "> {{ classified.city|safe }}</span>    
            </div>
          </a>
        </div>  
      {% endfor %}
    </div>
  <!-- End div for row of all classified ads-->
  </div>

  <div class="row">
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
      </ol>

      {# for profile in seller_profile #}
      {% for ad in official_ads %}
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img class="d-block w-100" src="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>...</h5>
            <p>...</p>
          </div>
        </div>

        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>


  <div class="row">
    <!-- Sidebar Widgets Column -->
    <div class="col-md-4">
      <!-- Write Classified Widget -->
      {% if request.user.is_authenticated %}
      <div class="text-center">
        <a class="btn btn-dark" href="{% url 'classifieds:write_new' %}" title="{% trans 'Write a new classified' %}"><i
            class="fa fa-pencil" aria-hidden="true"></i> {% trans 'New Classified' %}</a>

            {% if request.user.is_seller %}
            <a class="btn btn-dark" href="{% url 'classifieds:write_new_official' %}"
              title="{% trans 'Write a new official classified' %}"><i class="fa fa-pencil" aria-hidden="true"></i>
              {% trans 'New Classified' %}</a>
            {% endif %}
        <!--a class="btn btn-dark" href="{% url 'classifieds:list' %}" title="{% trans 'expired' %}"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> {% trans 'expired' %}</a-->
      </div>
      {% endif %}

      <!-- Cloud Tag Widget -->
      <div class="card my-4">
        <h5 class="card-header">{% trans 'Popular tags' %}</h5>
        <div class="card-body">
          {% for tag, count in popular_tags %}
          <a href="#"><span class="badge badge-info">{{ count }} {{ tag }}</span></a>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>


  {% if is_paginated %}
  <div class="row">
    <ul class="pagination justify-content-center mb-4">
      {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">&larr;
          {% trans 'Newer' %}</a></li>
      {% else %}
      <li class="page-item disabled"><a class="page-link" href="#"><span>&larr;</span></a></li>
      {% endif %}

          {% for i in paginator.page_range %}
              {% if page_obj.number == i %}
              <li class="page-item disabled"><a class="page-link" href="#">{{ i }} <span class="sr-only">(current)</span></a>
              </li>
              {% else %}
              <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}
          {% endfor %}

      {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">{% trans 'Older' %}
          &rarr;</a></li>
      {% else %}
      <li class="page-item disabled"><a class="page-link" href="#"><span>&rarr;</span></a></li>
      {% endif %}
    </ul>
  </div>
  {% endif %}


  <!-- /.row -->
</div>
<!-- /.container -->

{% endblock content %}
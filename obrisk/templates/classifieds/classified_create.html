{% extends 'base.html' %}
{% load static i18n %}
{% load crispy_forms_tags %}

{% block head %}
  <script src="{% static 'js/aliyun-oss.min.js' %}" type="text/javascript"></script>
  <link rel="stylesheet" href="/static/css/uploader.css" />
  <link href="{% static 'css/classifieds.css' %}" rel="stylesheet">
{% endblock head %}

{% block content %}

  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'classifieds:list' %}">{% trans 'Classifieds' %}</a></li>
      <li class="breadcrumb-item active" aria-current="page">{% trans 'Write a new classified' %}</li>
    </ol>
  </nav>
  <form action="{% url 'classifieds:write_new' %}" name="classifiedForm" enctype="multipart/form-data"  id="classified-form" method="post" role="form">
    {% csrf_token %}
    {{ form|crispy }}


      <div id="wrapper">
          <div id="container">
              <div id="uploader">
                  <div class="queueList">
                      <div id="dndArea" class="placeholder">
                          <div class="" id="uploaderPick">
                            <a id="chooseFile" href="javascript:void(0);" class="text">Click to select file</a>
                          </div>
                      </div> 
                  </div>
              </div>
              <div id="statusBar" class="statusBar align-items-center" style="display:none">
                  <div class="total-progress">
                      <div id="totalProgressBar"
                          class="total-progress-bar"
                          role="progressbar"
                          aria-valuenow="0"
                          aria-valuemin="0"
                          aria-valuemax="100"
                          style="min-width: 2em;">
                        0%
                      </div>
                  </div>
                  <div class="start-uploader">
                      <a id="startUpload" href="javascript:void(0);" class="text">Start upload</a>
                  </div>
                  <div class="start-uploader">
                      <a id="addBtn" href="javascript:void(0);" class="text">Keep adding</a>
                  </div>

              </div>
              <div class="" style="clear: both;">
              </div>
          </div>
      </div>

  <div class="container bs-docs-container">
      <form id="form">
          <input id="image-file" type="file"  style="display:none;" multiple="multiple"/>
      </form>
  </div>


    <div class="form-group"> <br>
      <button type="button" class="btn btn-dark create" >{% trans 'Submit' %}</button>
      <!--button type="button" class="btn btn-default draft">{% trans 'Save as draft' %}</button-->
      <a href="{% url 'classifieds:list' %}" class="btn btn-danger">{% trans 'Cancel' %}</a>
    </div>
  </form>
  {{ form.media }}


{% endblock content %}

{% block extra_js %}


<script type="text/javascript">

  const oss_url = "{% url 'get_oss_auth' %}"; ///classifieds/get_oss_auth/
  const user = "{{ request.user.username }}";

  $(function () {
    $(".create").click(function (event) {
        $("input[name='status']").val("A");
        console.log(images)
        $("#id_images").val(images);
        $("#classified-form").submit();
      
    }); 
    
    $(".draft").click(function () {
        $("input[name='status']").val("E");
        $("#classified-form").submit();
    });
});
    
</script>
<script src="{% static 'js/uploader.js' %}" type="text/javascript"></script>

{% endblock extra_js %}

  
{% load i18n %}
{% load humanize static %}
<div class="card is-post is-simple" stories-id="{{ stories.uuid_id }}">
  <!-- Main wrap -->
  <div class="content-wrap">
    <!-- Header -->
    <div class="card-heading">
      <!-- User image -->
      <div class="user-block">
        <div class="image">
          {% if stories.user.thumbnail %}
          <img src="https://obrisk.oss-cn-hangzhou.aliyuncs.com/{{stories.user.thumbnail}}" alt="Picture Profile"
            style="width:35px;height:35px;border-radius: 50%;"
            class="rounded-circle  mb-3 mb-md-0 mr-md-3 profile-header-avatar img-fluid" id="pic">
          {% else %}
          <img class="pull-left mr-2" src="{% static 'img/user.png' %}" height="35px" alt="No Profile Picture" />
          {% endif %}

        </div>
        <div class="user-info">
          <a href="/users/{{ stories.user.get_profile_name}}">{{ stories.user.get_profile_name|title }}</a>
          <span class="time">{{ stories.timestamp|naturaltime }}</span>
        </div>
      </div>
      <!-- /includes/pages/feed/dropdowns/feed-post-dropdown.html -->
      <div class="dropdown is-spaced is-right is-neutral dropdown-trigger">
        <div>
          <div class="button">
            <i data-feather="more-vertical"></i>
          </div>
        </div>
        <div class="dropdown-menu" role="menu">
          <div class="dropdown-content border-0">
            {% if reply.user == request.user %}
            <a href="#" class="dropdown-item">
              <div class="media">
                <i data-feather="trash-2"></i>
                <div class="media-content">
                  <h3>Delete</h3>
                  <small>Delete this story</small>
                </div>
              </div>
            </a>
            {% endif %}
            <a href="#" class="dropdown-item">
              <div class="media">
                <i data-feather="flag"></i>
                <div class="media-content">
                  <h3>Flag</h3>
                  <small>In case of inappropriate content.</small>
                </div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
    <!-- /Header -->


    <!-- Post body -->
    <div class="card-body">
      <!-- Post body text -->
      <div class="post-text">
        <p>{{ stories }}</p>
      </div>

    </div>
    <!-- /Post body -->

    <!-- Post image  -->
    <div class="post-image">
      <!-- CSS masonry wrap -->
      {{img1}}
    </div>
    <!-- /Post image  -->



    <!-- Post actions -->
    <div class="post-actions">
      <div class="like-wrapper">
        {% if request.user in stories.get_likers %}
        <a href="javascript:void(0);" class="like-button is-active">
          <i class="mdi mdi-heart not-liked bouncy"></i>
          <i class="mdi mdi-heart is-liked bouncy"></i>
          <span class="like-overlay"></span>
        </a>
        {% else %}
        <a href="javascript:void(0);" class="like-button">
          <i class="mdi mdi-heart not-liked bouncy"></i>
          <i class="mdi mdi-heart is-liked bouncy"></i>
          <span class="like-overlay"></span>
        </a>
        {% endif %}

      </div>

      <div class="fab-wrapper is-comment">
        <a href="javascript:void(0);" class="small-fab">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="feather feather-message-circle">
            <path
              d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
            </path>
          </svg>
        </a>
      </div>
    </div>
    <!-- /Post actions  -->

    <!-- Post footer -->
    <div class="card-footer">
      <!-- Followers -->
      {% if stories.get_likers %}
      <div class="likers-group">
        {% for liker in stories.get_likers %}
        <img src="{{oss}}/{{liker.thumbnail|default_if_none:'/static/img/user.png' }}" alt="User profile picture">
        {% endfor %}
      </div>
      <div class="likers-text">
        <p>
          {% for liker in stories.get_likers %}
          {% if liker.last %}
          <a href="/users/{{liker}}">{{liker}}</a>
          {% else %}
          <a href="/users/{{liker}}">{{liker}}</a>,
          {% endif %}
          {% endfor %}
        </p>
        {% if stories.get_likers|length > 3%}
        <p>and {{ stories.get_likers|length|add:"-3" }} more liked this</p>
        {% else %}
        <p>liked this</p>
        {% endif%}
      </div>
      {% else %}
      <div class="likers-text">
        <p>Be the first to like</p>
      </div>
      {% endif %}
      <!-- Post statistics -->
      <div class="social-count">

        <div class="likes-count">
          <span class="count">{{ stories.likes_count }}</span>
          <span>Liked</span>
        </div>
        <div class="comments-count">
          <span class="count">{{ stories.thread_count }}</span>
          <span>Comments</span>
        </div>
      </div>
    </div>
    <!-- /Post footer -->
  </div>
  <!-- /Main wrap -->

  <!-- Post #6 comments -->
  <div class="comments-wrap is-hidden">
    <!-- Header -->
    <div class="comments-heading">
      <h4>
        Comments
        (<small>{{ stories.thread_count }}</small>)
      </h4>
      <div class="close-comments">
        <i data-feather="x"></i>
      </div>
    </div>
    <!-- /Header -->

    <!-- Comments body -->
    <div class="comments-body has-slimscroll">
      <div class="comments-placeholder">
        <img src="{% static 'assets/images/icons/feed/bubble.svg' %}" alt="">
        <h3>Nothing in here yet</h3>
        <p>Be the first to post a comment.</p>
      </div>
    </div>
    <!-- /Comments body -->

    <!-- Comments footer -->
    <div class="card-footer">
      <div class="media post-comment">
        <!-- Textarea -->
        <div class="media-content">
          <div class="field textarea-parent">
            <p class="counter" style="font-size: .8rem;color: #999;float: right;">Remaining: <span class="count">400
              </span>Character
            </p>
            <p class="control">
              <form role="form" method="post" action="#" onsubmit="return false" class="replyStoriesForm">
                {% csrf_token %}
                <input type="hidden" name="parent" value="">
                <textarea class="textarea" name="reply" rows="2" class="textarea comment-textarea"
                  placeholder="Write a comment...">
                  </textarea>

              </form>
            </p>
          </div>
          <!-- Additional actions -->
          <div class="actions">
            <a id="post-comment-button" class="button primary-button is-solid raised">Post Comment</a>
          </div>
        </div>
      </div>
    </div>
    <!-- /Comments footer -->
  </div>
  <!-- /Post #6 comments -->
</div>

<!-- Todo: Create json ld for stories -->
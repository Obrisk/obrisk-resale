function printError(e){template=`\n        <div class="alert alert-danger alert-dismissible fade show" role="alert">\n          ${e}\n          <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n            <span aria-hidden="true">&times;</span>\n          </button>\n        </div>\n        `,$(".form-panel").prepend(template)}var phone_no,verify_counter=0,code_counter=0;$((function(){$("#send-code").click((function(e){if($("#id_phone_number").val()){var n,t,s=parseInt($("#id_phone_number").val()),a=s.toString();if(!isNaN(s)&&11==a.length&&1==a.charAt(0))return"/users/phone-password-reset/"==current_url?(n="/users/phone-password-reset/",t="POST"):(n="/users/verification-code/",t="GET"),$.ajax({url:n,data:{phone_no:s},cache:!1,type:t,success:function(e){if(1==e.success){timeout=60,$("#send-code").attr("disabled",!0),$("#phone_label").hide(),$("#code").hasClass("d-none")&&$("#code").toggleClass("d-none"),$("#email-request").hasClass("d-none")&&$("#email-request").toggleClass("d-none"),null!=e.message&&($("#code-notice").empty().append("<p class='blue-link'>"+e.message+"<p>"),document.getElementById("code-input").focus());let n=setInterval(()=>(timeout--,void(timeout>0?$("#send-code").text(timeout+" S"):($("#send-code").text("Get Code"),$("#send-code").attr("disabled",!1)))),1e3);setTimeout(()=>{clearInterval(n)},61e3),(verify_counter+=1)>=7&&($("#send-code").attr("disabled",!0),printError("Maximum number of sending SMS has reached, Try again later!"))}else null!=e.error_message&&$("#code-notice").empty().append("<p class='blue-link'>"+e.error_message+"<p>"),null!=e.messageId&&console.log(e.messageId),null!=e.requestId&&console.log(e.requestId),null!=e.returnedCode&&console.log(e.returnedCode),null!=e.retries&&console.log(e.retries)},error:function(e){$("#code-notice").empty().append("<p class='blue-link'> Sorry the signup is closed! Please try again later!<p>"),console.log(e)}}),!1;e.preventDefault(),$("#code-notice").empty().append("<p class='blue-link'>Invalid number. Don't include country code/spaces/special characters<p>")}else e.preventDefault(),$("#code-notice").empty().append("<p class='blue-link'>Empty input. Please enter a valid phone number!<p>")})),$("input[name='code']").keyup((function(e){if(6==e.target.value.length){if($(".loading").toggleClass("d-none"),!isNaN($("input[name='code']").val())&&6==$("input[name='code']").val().length&&!isNaN($("#id_phone_number").val())&&11==$("#id_phone_number").val().length&&1==$("#id_phone_number").val().charAt(0))return $.ajax({url:"/users/phone-verify/",data:{phone_no:$("#id_phone_number").val(),code:$("input[name='code']").val()},cache:!1,type:"GET",success:function(e){1==e.success?(e.url?($("#results").empty().append("<p class='blue-link'>Successfully verified your number! Redirecting... <p>"),window.location.href=e.url):($("#results").empty().append("<p class='blue-link'> You have successfully verified your phone number! <p>"),$("input[name='verified_no']").val("YES"),$("#phone_label").hide(),$("#code-notice").empty(),$("#code").hide(),$("#send-code").hide(),$("#email-request").hide(),$("#signup-panel-1").hide(),$(".process-panel-wrap").removeClass("is-active"),$(".step-title").removeClass("is-active")),$(".step-dot-2").addClass("is-active")):($("#results").empty().append("<p class='text-error '>"+e.error_message+"</p>"),$("#send-code").attr("disabled",!1),(code_counter+=1)>=5&&($("#phone-verify").attr("disabled",!0),printError("Maximum number of code retrial has reached, you can't retry anymore!"))),$(".loading").toggleClass("d-none")},error:function(e){printError(e)}}),!1;event.preventDefault()}})),$("#phone-verify").click((function(){})),$(".process-button").on("click",(function(){var e=$(this),n=e.attr("data-step");"step-dot-3"==n&&(e.addClass("is-loading"),setTimeout((function(){e.removeClass("is-loading"),$(".process-panel-wrap").removeClass("is-active"),$("."+n).addClass("is-active")}),500))})),$("#signup-finish").on("click",(function(){var e=$(this);e.addClass("is-loading"),setTimeout((function(){window.location="/stories"}),800)}))})),$("#social-signup-submit").click((function(e){$("input[name='verified_no']").val()?($("#id_phone_number").attr("disabled",!1),0==$("#id_phone_number").val().toString().startsWith("+86")&&$("#id_phone_number").val("+86"+$("#id_phone_number").val()),$("input[name='city']").val($("select[name='city']").val()),$("input[name='province_region']").val($("select[name='province']").val()),$("#signup_form").submit()):(e.preventDefault(),printError("Please verify your phone number before submitting the form!"))}));